{% extends "base.html" %}
{% block content %}

<h2 class="mb-4">ğŸ“Š EstatÃ­sticas Gerais</h2>

<div class="card p-3 mb-4 shadow-sm">
  <ul class="list-group">
    <li class="list-group-item">Total de tarefas: <strong>{{ total }}</strong></li>
    <li class="list-group-item">ConcluÃ­das: <strong>{{ done }}</strong> ({{ percent_done|round(1) }}%)</li>
    <li class="list-group-item">Em andamento: <strong>{{ doing }}</strong></li>
    <li class="list-group-item">Pendentes: <strong>{{ pending }}</strong></li>
    <li class="list-group-item">MÃ©dia de prioridade (1â€“3): <strong>{{ avg_priority|round(2) }}</strong></li>
  </ul>
</div>

<h3 class="mt-4 mb-3 text-center">ğŸ“… Tarefas Criadas por Dia</h3>

<div class="card p-4 shadow-sm mb-4">
  <canvas id="dailyChart" width="400" height="200"></canvas>
</div>

<a href="{{ url_for('index') }}" class="btn btn-secondary">â† Voltar</a>

<!-- Importa o Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
  // Dados enviados do Flask para o template
  const labels = {{ daily_counts | map(attribute=0) | list | tojson }};
  const values = {{ daily_counts | map(attribute=1) | list | tojson }};

  const data = {
    labels: labels,
    datasets: [{
      label: 'Tarefas criadas',
      data: values,
      borderColor: 'rgb(75, 192, 192)',
      backgroundColor: 'rgba(75, 192, 192, 0.3)',
      borderWidth: 2,
      fill: true,
      tension: 0.3
    }]
  };

  const config = {
    type: 'bar',
    data: data,
    options: {
      scales: {
        y: { beginAtZero: true }
      }
    }
  };

  // Cria o grÃ¡fico
  new Chart(document.getElementById('dailyChart'), config);
</script>

{% endblock %}
